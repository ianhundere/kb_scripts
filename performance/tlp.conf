# TLP Configuration for ThinkPad T14s AMD Gen 1
# TLP 1.9.0 - Three Power Profile System
#
# Profiles:
#   - Performance (AC): _AC suffix - when on AC power or manually selected
#   - Balanced (BAT):   _BAT suffix - when on battery or manually selected
#   - Power-Saver (SAV): _SAV suffix - maximum battery savings (NEW in 1.9.0)
#
# Switch profiles via GUI: tlpui or desktop power settings

TLP_ENABLE=1
TLP_DEFAULT_MODE=BAT

# CPU Scaling Governor
# performance: maximum frequency | powersave: dynamic scaling
CPU_SCALING_GOVERNOR_ON_AC=performance
CPU_SCALING_GOVERNOR_ON_BAT=powersave
CPU_SCALING_GOVERNOR_ON_SAV=powersave

# CPU Energy/Performance Policy (EPP)
# performance: max performance | balance_performance: balanced | power: max savings
CPU_ENERGY_PERF_POLICY_ON_AC=performance
CPU_ENERGY_PERF_POLICY_ON_BAT=balance_performance
CPU_ENERGY_PERF_POLICY_ON_SAV=power

# CPU Turbo Boost
# 1: enabled | 0: disabled
CPU_BOOST_ON_AC=1
CPU_BOOST_ON_BAT=0
CPU_BOOST_ON_SAV=0

# CPU Hardware P-State Dynamic Boost
# 1: enabled | 0: disabled
CPU_HWP_DYN_BOOST_ON_AC=1
CPU_HWP_DYN_BOOST_ON_BAT=0
CPU_HWP_DYN_BOOST_ON_SAV=0

# Scheduler Power Save
# 0: disabled | 1: enabled
SCHED_POWERSAVE_ON_AC=0
SCHED_POWERSAVE_ON_BAT=1
SCHED_POWERSAVE_ON_SAV=1

# NMI Watchdog (disable for power savings)
NMI_WATCHDOG=0

# Platform Profile (ACPI platform driver)
# performance | balanced | low-power | quiet | cool
PLATFORM_PROFILE_ON_AC=performance
PLATFORM_PROFILE_ON_BAT=low-power
PLATFORM_PROFILE_ON_SAV=low-power

# Disk Idle Time (seconds before disk spindown)
DISK_IDLE_SECS_ON_AC=0
DISK_IDLE_SECS_ON_BAT=2
DISK_IDLE_SECS_ON_SAV=2

# Max Lost Work (seconds of data buffered for write)
MAX_LOST_WORK_SECS_ON_AC=15
MAX_LOST_WORK_SECS_ON_BAT=15
MAX_LOST_WORK_SECS_ON_SAV=60

# WiFi Power Management
# off: disabled | on: enabled
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=on
WIFI_PWR_ON_SAV=on

# Wake on LAN
WOL_DISABLE=Y

# Audio Power Save
# 0: disabled | 1: enabled (with 1 second timeout)
SOUND_POWER_SAVE_ON_AC=0
SOUND_POWER_SAVE_ON_BAT=1
SOUND_POWER_SAVE_ON_SAV=1

# PCIe Active State Power Management
# default | performance | powersave | powersupersave
PCIE_ASPM_ON_AC=default
PCIE_ASPM_ON_BAT=powersupersave
PCIE_ASPM_ON_SAV=powersupersave

# Runtime Power Management
# on: enabled | auto: automatic | default: kernel default
RUNTIME_PM_ON_AC=on
RUNTIME_PM_ON_BAT=auto
RUNTIME_PM_ON_SAV=auto

# USB Autosuspend
USB_AUTOSUSPEND=1
USB_DENYLIST="04f2:b67c 8087:0026"
USB_EXCLUDE_BTUSB=1
USB_EXCLUDE_PHONE=1

# Device State on Startup
RESTORE_DEVICE_STATE_ON_STARTUP=0

DEVICES_TO_DISABLE_ON_STARTUP="bluetooth wwan nfc"
DEVICES_TO_ENABLE_ON_STARTUP="wifi"

DEVICES_TO_DISABLE_ON_BAT_NOT_IN_USE="bluetooth wwan nfc"

# Battery Charge Thresholds (ThinkPad)
# Start charging at 40%, stop at 80% for battery longevity
START_CHARGE_THRESH_BAT0=40
STOP_CHARGE_THRESH_BAT0=80

RESTORE_THRESHOLDS_ON_BAT=1

# ThinkPad Battery Features
NATACPI_ENABLE=1
TPACPI_ENABLE=1
TPSMAPI_ENABLE=0
